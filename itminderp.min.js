function UserController(e,t,r,n){var i=this;i.users,i.error,i.getUsers=function(){console.log(n.authenticated),e.get("http://localhost:8000/api/users/").success(function(e){i.users=e}).error(function(e){i.error=e})},i.getUsers()}function SubscriptionController(e,t,r){var n=this;n.courts=[],n.userCourts=[],n.onSubmit=function(){e.post(r+"courts",{courts:n.userCourts},{timeout:3e5}).success(function(){t.go("judgements")}).error(function(e){console.log(e)})},e.get(r+"courts").success(function(e){n.courts=e.data}).error(function(e){n.error=e}),e.get(r+"user/courts").success(function(e){n.userCourts=e.data}).error(function(e){n.error=e})}function JudgementController(e,t){var r=this;r.judgements=[],e.get(t+"judgements").success(function(e){r.judgements=e.data}).error(function(e){r.error=e})}function AuthController(e,t,r,n,i){var o=this;o.loginError=!1,o.loginErrorText="",n.authenticated=e.isAuthenticated(),o.login=function(){var a={email:o.email,password:o.password};e.login(a).then(function(){return r.get(i+"authenticate/user")},function(e){o.loginError=!0,o.loginErrorText=e.data.error}).then(function(e){if(angular.isDefined(e)){var r=JSON.stringify(e.data.user);localStorage.setItem("user",r),n.authenticated=!0,console.log(n.authenticated),n.currentUser=e.data.user,t.go("subscriptions")}})},o.logout=function(){e.logout().then(function(){localStorage.removeItem("user"),n.authenticated=!1,n.currentUser=null,t.go("auth")})}}angular.module("itminderp",["ui.router","satellizer","ngMaterial","ngMessages","textAngular"]).constant("API_URL","http://localhost:8000/api/").config(["$stateProvider","$urlRouterProvider","$authProvider","$mdThemingProvider","$mdIconProvider","API_URL","$httpProvider","$provide",function(e,t,r,n,i,o,a,s){function l(e,t){return{responseError:function(r){var n=t.get("$state"),i=["token_not_provided","token_expired","token_absent","token_invalid"];return angular.forEach(i,function(e){r.data.error===e&&(localStorage.removeItem("user"),n.go("auth"))}),e.reject(r)}}}n.theme("black").primaryPalette("grey",{"default":"900"}),n.setDefaultTheme("black"),l.$inject=["$q","$injector"],s.factory("redirectWhenLoggedOut",l),a.interceptors.push("redirectWhenLoggedOut"),r.loginUrl=o+"authenticate",r.httpInterceptor=!0,r.withCredentials=!0,r.tokenRoot=null,r.cordova=!1,r.baseUrl="/",r.tokenName="token",r.tokenPrefix="satellizer",r.authHeader="Authorization",r.authToken="Bearer",r.storageType="localStorage",t.otherwise("/judgements"),e.state("auth",{url:"/auth",templateUrl:"partials/authView.html",controller:"AuthController as auth"}).state("users",{url:"/users",templateUrl:"partials/userView.html",controller:"UserController as user"}).state("subscriptions",{url:"/courts",templateUrl:"partials/subscription.html",controller:"SubscriptionController as subscription"}).state("judgements",{url:"/judgements",templateUrl:"partials/judgements.html",controller:"JudgementController as jg"})}]),angular.module("itminderp").controller("UserController",UserController),UserController.$inject=["$http","$auth","$state","$rootScope"],angular.module("itminderp").controller("SubscriptionController",SubscriptionController),SubscriptionController.$inject=["$http","$state","API_URL"],angular.module("itminderp").controller("JudgementController",JudgementController),JudgementController.$inject=["$http","API_URL"],angular.module("itminderp").controller("AuthController",AuthController),AuthController.$inject=["$auth","$state","$http","$rootScope","API_URL"],function(e){try{e=angular.module("itminderp")}catch(t){e=angular.module("itminderp",[])}e.run(["$templateCache",function(e){e.put("/itminderp/partials/authView.html",'<div class="row middle-xs" style="height: 100%"><div class="col-xs-offset-4 col-xs-4"><md-card><div class="col-xs-4 col-xs-offset-4"><h3>Login</h3></div><md-divider></md-divider><md-card-content><p>{{auth.loginErrorText}}</p><form name="login" class="ng-pristine ng-valid-email ng-invalid ng-invalid-required"><md-input-container class="md-cyan-theme"><label for="email" translate="" class="ng-scope">Email</label><input id="email" label="email" name="email" type="email" ng-model="auth.email" required class="ng-pristine ng-untouched md-input ng-valid-email ng-invalid ng-invalid-required" tabindex="0" aria-required="true" aria-invalid="true"><div ng-messages="login.email.$error" aria-live="assertive" class="ng-active"><div ng-message="" when="required" class="ng-scope"><span translate="" class="ng-scope">Please enter your email address.</span></div></div></md-input-container><md-input-container class="md-cyan-theme"><label for="password" translate="" class="ng-scope">Password</label><input id="password" label="password" name="password" type="password" ng-model="auth.password" required class="ng-pristine ng-untouched md-input ng-invalid ng-invalid-required" tabindex="0" aria-required="true" aria-invalid="true"><div ng-messages="" for="login.password.$error" aria-live="assertive" class="ng-active"><div ng-message="" when="required" class="ng-scope"><span translate="" class="ng-scope">Please enter your password.</span></div></div></md-input-container><md-button type="button" class="md-raised no-margin" ng-click="auth.login()" ng-disabled="login.$invalid">Login</md-button></form></md-card-content></md-card></div></div>')}])}(),function(e){try{e=angular.module("itminderp")}catch(t){e=angular.module("itminderp",[])}e.run(["$templateCache",function(e){e.put("/itminderp/partials/judgements.html",'<div ng-cloak><md-content><md-list><md-subheader class="md-no-sticky">Judgements</md-subheader><md-list-item class="md-3-line" ng-repeat="judgement in jg.judgements"><div class="md-list-item-text" layout="column"><h4>{{ judgement.courtName}}</h4><p>{{ judgement.appellant }} vs. {{judgement.respondent}}</p><p>{{ judgement.description}}</p><md-divider></md-divider></div></md-list-item></md-list></md-content></div>')}])}(),function(e){try{e=angular.module("itminderp")}catch(t){e=angular.module("itminderp",[])}e.run(["$templateCache",function(e){e.put("/itminderp/partials/subscription.html",'<div class="row"><div class="col-xs-6"><h3>Choose courts</h3><md-select multiple ng-model="subscription.userCourts"><md-option ng-repeat="court in subscription.courts" value="{{court.id}}">{{court.name}}</md-option></md-select><md-button ng-click="subscription.onSubmit()" class="md-raised">Submit</md-button></div></div>')}])}(),function(e){try{e=angular.module("itminderp")}catch(t){e=angular.module("itminderp",[])}e.run(["$templateCache",function(e){e.put("/itminderp/partials/userView.html",'<div class="row"><div class="col-xs-6"><h3>Users</h3><ul class="list-group" ng-if="user.users"><li class="list-group-item" ng-repeat="user in user.users"><h4>{{user.name}}</h4><h5>{{user.email}}</h5></li></ul><div class="alert alert-danger" ng-if="user.error"><strong>There was an error:</strong> {{user.error.error}}<br>Please go back and login again</div></div></div>')}])}();